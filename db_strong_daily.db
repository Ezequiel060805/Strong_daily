
--####################################################################################
--#########################TABLES OF THE DATABASE#####################################
--####################################################################################
-- TABLES FOR USERS
CREATE TABLE Users(
    user_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    last_name TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL
);

CREATE TABLE Measures(
    user_id INTEGER NOT NULL,
    measure_date DATE NOT NULL,
    weight NUMERIC,
    shoulders NUMERIC,
    chest NUMERIC,
    waist NUMERIC,
    abdomen NUMERIC,
    hips NUMERIC,
    glutes NUMERIC,
    thighs NUMERIC,
    calves NUMERIC,
    arm_left NUMERIC,
    arm_right NUMERIC,
    leg_left NUMERIC,  
    leg_right NUMERIC,
    calf_left NUMERIC,
    calf_right NUMERIC,
    PRIMARY KEY (user_id, measure_date),  -- Clave primaria compuesta
    FOREIGN KEY (user_id) REFERENCES Users(user_id)
);
--  TABLES FOR THE CORRECT APP FUNTIONALITY 

CREATE TABLE Categories(  
    category_id INTEGER PRIMARY KEY AUTOINCREMENT,
    muscle_works TEXT NOT NULL,
    type_exercises TEXT NOT NULL
);

CREATE TABLE Routines(
    routine_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    description TEXT NOT NULL,
    category_id INTEGER,
    FOREIGN KEY (category_id) REFERENCES Categories(category_id)
);

CREATE TABLE Exercises(
    exercise_id INTEGER PRIMARY KEY AUTOINCREMENT,
    category_id INTEGER NOT NULL,
    name TEXT NOT NULL,
    description TEXT NOT NULL,
    FOREIGN KEY (category_id) REFERENCES Categories(category_id)
);

CREATE TABLE Routine_exercises (
    routine_exercise_id INTEGER PRIMARY KEY AUTOINCREMENT,
    routine_id INTEGER NOT NULL,
    exercise_id INTEGER NOT NULL,
    exercise_order INTEGER,
    notes TEXT,
    FOREIGN KEY (routine_id) REFERENCES Routines(routine_id) ON DELETE CASCADE,
    FOREIGN KEY (exercise_id) REFERENCES Exercises(exercise_id)
);

CREATE TABLE Sets (
    set_id INTEGER PRIMARY KEY AUTOINCREMENT,
    routine_exercise_id INTEGER NOT NULL,
    set_order INTEGER,
    reps INTEGER NOT NULL,
    weight REAL NOT NULL,
    FOREIGN KEY (routine_exercise_id) REFERENCES Routine_exercises(routine_exercise_id) ON DELETE CASCADE
);
--####################################################################################
--#########################INSERTS FOR TESTING########################################
--####################################################################################
-- Insertar usuarios
INSERT INTO Users (name, last_name, email) VALUES
    ('Juan', 'Pérez', 'juan.perez@example.com'),
    ('María', 'Gómez', 'maria.gomez@example.com');

-- Insertar categorías
INSERT INTO Categories (muscle_works, type_exercises) VALUES
    ('Pecho, hombros, tríceps', 'Fuerza'),
    ('Piernas, glúteos', 'Hipertrofia'),
    ('Core, cuerpo completo', 'Funcional');

-- Insertar rutinas
INSERT INTO Routines (name, description, category_id) VALUES
    ('Rutina Push', 'Entrenamiento de empuje', 1),
    ('Pierna intensa', 'Sesión de pierna completa', 2);

-- Insertar ejercicios
INSERT INTO Exercises (category_id, name, description) VALUES
    (1, 'Press banca', 'Ejercicio básico para pecho'),
    (1, 'Fondos en paralelas', 'Desarrollo de tríceps y pecho'),
    (2, 'Sentadillas', 'Ejercicio rey para piernas'),
    (2, 'Peso muerto', 'Trabajo completo de cadena posterior');

-- Insertar ejercicios en rutinas
INSERT INTO Routine_exercises (routine_id, exercise_id, exercise_order, notes) VALUES
    (1, 1, 1, 'Calentamiento progresivo'),
    (1, 2, 2, 'Mantener torso erguido'),
    (2, 3, 1, 'Controlar la bajada'),
    (2, 4, 2, 'Mantener espalda neutral');

-- Insertar series de entrenamiento
INSERT INTO Sets (routine_exercise_id, set_order, reps, weight) VALUES
    (1, 1, 12, 20.0),  -- Press banca: Serie 1
    (1, 2, 10, 25.0),  -- Press banca: Serie 2
    (2, 1, 15, NULL),  -- Fondos: Serie 1 (peso corporal)
    (3, 1, 10, 40.0),  -- Sentadillas: Serie 1
    (3, 2, 8, 50.0);   -- Sentadillas: Serie 2

-- Insertar medidas corporales
INSERT INTO Measures (user_id, measure_date, weight, shoulders, chest, waist, leg_left, leg_right) VALUES
    (1, '2023-10-01', 75.5, 110.0, 95.0, 80.0, 55.0, 55.5),
    (1, '2023-11-01', 74.0, 112.0, 96.5, 78.0, 56.0, 56.0),
    (2, '2023-10-15', 62.0, 95.0, 85.0, 70.0, 50.0, 50.5);
    
--####################################################################################
--#########################PROCEDURES#################################################
--####################################################################################
-- Create new user